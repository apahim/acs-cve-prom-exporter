# acs-cve-prom-exporter

## Run

```
$ export ACS_ENDPOINT="https://acs.central.example.com"
$ export ACS_TOKEN="***"
$ go run main.go 
```

## Get Metrics

```
$ curl http://localhost:9090
# HELP acs_cvss Common Vulnerability Scoring System
# TYPE acs_cvss gauge
acs_cvss{cluster="cluter01",cve="CVE-2022-25883",deploymentCount="1",imageId="sha256:1231231231231231231231231231231231231231231231231231231231231231",imageRegistry="quay.io",imageRemote="registry/splunk-forwarder-operator",imageTag="",isFixable="true",namespace="splunk-forwarder-operator",operatingSystem="rhel:8",severity="MODERATE_VULNERABILITY_SEVERITY"} 7.5
acs_cvss{cluster="cluter01",cve="CVE-2023-37920",deploymentCount="1",imageId="sha256:1231231231231231231231231231231231231231231231231231231231231231",imageRegistry="quay.io",imageRemote="registry/deployment-validation-operator",imageTag="latest",isFixable="true",namespace="deployment-validation-operator",operatingSystem="rhel:8",severity="LOW_VULNERABILITY_SEVERITY"} 9.100000381469727
...
```
